##Load library UpSetR
library(UpSetR)
##Change working directory to Github folder
setwd("C:/Users/r1d1n/Documents/GitHub/SetUpdata")
#LoadFileContainingVenn
array <- read.csv("Transcriptomes_Cold_Adrenergic_PathEnrichment_DownDEG_ExceptGSE51080.csv", header=T, sep="," )
#PlotResults
upset(array,nsets = 7, sets.bar.color = "#56B4E9",order.by = "freq", empty.intersections = "on")
#LoadFileContainingVenn
array <- read.csv("Transcriptomes_Cold_Adrenergic_PathEnrichment_UpDEG_ExceptGSE51080.csv", header=T, sep="," )
#PlotResults
upset(array,nsets = 7, sets.bar.color = "#56B4E9",order.by = "freq", empty.intersections = "on")
###Pathway Enrichment DownDEG except GSE51080
#LoadFileContainingVenn
array <- read.csv("Transcriptomes_Cold_Adrenergic_PathEnrichment_DownDEG_ExceptGSE51080.csv", header=T, sep="," )
#PlotResults
upset(array,nsets = 7, sets.bar.color = "#56B4E9",order.by = "freq", empty.intersections = "on")
#LoadFileContainingVenn
array <- read.csv("Transcriptomes_Cold_Adrenergic_PathEnrichment_UpDEG_ExceptGSE51080.csv", header=T, sep="," )
#PlotResults
upset(array,nsets = 7, sets.bar.color = "#56B4E9",order.by = "freq", empty.intersections = "on")
groupColors <- c("#FF7C33", "#DF8BE8", "#A6C9FF", "#29EB5F", "#FFEA26", "#6041FF", "#E82E45")
chorddiag(DEGsTissue, type = "directional", showTicks = F, groupnameFontsize = 14, groupnamePadding = 10, margin = 90)
chorddiag(DEGsTissueExceptGSE51080, groupColors = groupColors, type = "directional", showTicks = F, groupnameFontsize = 14, groupnamePadding = 10, margin = 90)
## 7. Create frame with share DEGs among transcriptomes in percentage
DEGsTissuePercentage = data_frame('ArrayNostre' = c(1, 0.317929759704251, 0.153419593345656, 0.105360443622921, 0.397412199630314, 0.269870609981516, 0.493530499075786, 0.210720887245841),
'GSE13432_7d' = c(0.317929759704251, 1, 0.173216885007278, 0.0669577874818049, 0.323871906841339, 0.183406113537118, 0.493449781659389, 0.0815138282387191),
'GSE13432_35d' = c(0.153419593345656, 0.173216885007278, 1, 0.127705627705628, 0.393939393939394, 0.25974025974026, 0.562770562770563, 0.149350649350649),
'GSE51080_10d' = c(0.105360443622921, 0.0669577874818049, 0.127705627705628, 1, 0.3203125, 0.2421875, 0.463541666666667, 0.15625),
'GSE55934_Adre_10d' = c(0.397412199630314, 0.323871906841339, 0.393939393939394, 0.3203125, 1, 0.1, 0.372965879265092, 0.0388451443569554),
'GSE98132_Adre_3d' = c(0.269870609981516, 0.183406113537118, 0.25974025974026, 0.2421875, 0.1, 1, 0.625128733264676, 0.127703398558187),
'GSE108077_7d' = c(0.493530499075786, 0.493449781659389, 0.562770562770563, 0.463541666666667, 0.372965879265092, 0.625128733264676, 1, 0.0363832077502691),
'GSE110420_10d' = c(0.210720887245841, 0.0815138282387191, 0.149350649350649, 0.15625, 0.0388451443569554, 0.127703398558187, 0.0363832077502691, 1))
DEGsTissuePercentage = as.matrix(DEGsTissuePercentage)
row.names(DEGsTissuePercentage) = c(colnames(DEGsTissuePercentage))
DEGsTissuePercentage
## 8. Create frame with share DEGs among transcriptomes in percentage except the array 'GSE51080_10d'
DEGsTissuePercentageExceptGSE51080 = data_frame('ArrayNostre' = c(1, 0.348056537102473, 0.190812720848057, 0.424028268551237, 0.302120141342756, 0.515901060070671, 0.245583038869258),
'GSE13432_7d' = c(0.348056537102473, 1, 0.187991422444603, 0.335954253037884, 0.197998570407434, 0.502501786990708, 0.097927090779128),
'GSE13432_35d' = c(0.190812720848057, 0.187991422444603, 1, 0.425051334702259, 0.297741273100616, 0.585215605749487, 0.193018480492813),
'GSE55934_Adre_10d' = c(0.424028268551237, 0.335954253037884, 0.425051334702259, 1, 0.105867014341591, 0.377053455019557, 0.0451108213820078),
'GSE98132_Adre_3d' = c(0.302120141342756, 0.197998570407434, 0.297741273100616, 0.105867014341591, 1, 0.634538152610442, 0.149598393574297),
'GSE108077_7d' = c(0.515901060070671, 0.502501786990708, 0.585215605749487, 0.377053455019557, 0.634538152610442, 1, 0.041541755888651),
'GSE110420_10d' = c(0.245583038869258, 0.097927090779128, 0.193018480492813, 0.0451108213820078, 0.149598393574297, 0.041541755888651, 1))
DEGsTissuePercentageExceptGSE51080 = as.matrix(DEGsTissuePercentageExceptGSE51080)
row.names(DEGsTissuePercentageExceptGSE51080) = c(colnames(DEGsTissuePercentageExceptGSE51080))
DEGsTissuePercentageExceptGSE51080
## 9. Graph the data
chorddiag(DEGsTissuePercentage, type = "directional", showTicks = F, groupnameFontsize = 14, groupnamePadding = 10, margin = 90)
chorddiag(DEGsTissuePercentageExceptGSE51080, groupColors = groupColors, type = "directional", showTicks = F, groupnameFontsize = 14, groupnamePadding = 10, margin = 90)
